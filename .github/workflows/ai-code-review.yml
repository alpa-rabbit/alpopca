name: Claude Code Review

on:
  pull_request:
    types: [opened, synchronize]
  issue_comment:
    types: [created]

jobs:
  # PR ì—´ë¦´ ë•Œ / ì»¤ë°‹ ì¶”ê°€ë  ë•Œ
  pr-review:
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
      id-token: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Claude Code Review
        uses: anthropics/claude-code-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          direct_prompt: |
            ë‹¹ì‹ ì€ ì‹œë‹ˆì–´ ê°œë°œìì…ë‹ˆë‹¤. ì´ PRì„ ë¦¬ë·°í•´ì£¼ì„¸ìš”.
            
            ## í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
            - Spring Boot ê¸°ë°˜ ë°±ì—”ë“œ / React í”„ë¡ íŠ¸ì—”ë“œ
            - í´ë¦° ì•„í‚¤í…ì²˜ ì§€í–¥
            - í¬íŠ¸í´ë¦¬ì˜¤ í”„ë¡œì íŠ¸
            
            ## ë¦¬ë·° ê¸°ì¤€
            
            ### ë°˜ë“œì‹œ ì§€ì  (ğŸš¨)
            - NullPointerException ê°€ëŠ¥ì„±
            - ì˜ˆì™¸ ì²˜ë¦¬ ëˆ„ë½
            - SQL Injection, XSS ë“± ë³´ì•ˆ ì·¨ì•½ì 
            - ëª…ë°±í•œ ë¡œì§ ì˜¤ë¥˜
            
            ### ê¶Œì¥ ê°œì„  (ğŸ’¡)
            - ë” ë‚˜ì€ ë„¤ì´ë°
            - ì¤‘ë³µ ì½”ë“œ ì œê±°
            - ì„±ëŠ¥ ê°œì„  í¬ì¸íŠ¸
            - í…ŒìŠ¤íŠ¸ ì¶”ê°€ í•„ìš”í•œ ë¶€ë¶„
            
            ### ì¹­ì°¬í•  ì  (âœ…)
            - ì¢‹ì€ ì„¤ê³„ë‚˜ íŒ¨í„´ ì‚¬ìš©
            - ê°€ë…ì„± ì¢‹ì€ ì½”ë“œ
            
            ## ì‘ë‹µ í˜•ì‹
            
            ### ìš”ì•½
            í•œ ì¤„ë¡œ ì „ì²´ í‰ê°€
            
            ### ì£¼ìš” í”¼ë“œë°±
            íŒŒì¼ë³„ë¡œ êµ¬ì²´ì ì¸ ë¼ì¸ ì–¸ê¸‰í•˜ë©° í”¼ë“œë°±
            
            ### ì§ˆë¬¸
            ì˜ë„ê°€ ë¶ˆë¶„ëª…í•œ ë¶€ë¶„ ì§ˆë¬¸
            
            ---
            
            ì‚¬ì†Œí•œ ìŠ¤íƒ€ì¼ ì´ìŠˆëŠ” ë¬´ì‹œí•˜ê³ , ì¤‘ìš”í•œ ê²ƒë§Œ ì§‘ì¤‘í•´ì£¼ì„¸ìš”.
            ì „ì²´ í”¼ë“œë°±ì€ 5ê°œ ì´ë‚´ë¡œ ì œí•œí•´ì£¼ì„¸ìš”.
            í•œêµ­ì–´ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

  # @claude ë©˜ì…˜ ëŒ“ê¸€ì— ì‘ë‹µ
  comment-response:
    if: |
      github.event_name == 'issue_comment' && 
      github.event.issue.pull_request && 
      contains(github.event.comment.body, '@claude')
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
      id-token: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Claude Response
        uses: anthropics/claude-code-action@beta
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
